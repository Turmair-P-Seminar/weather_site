<!DOCTYPE html>

<html lang="<%= lang %>">

<head>
    <title><%= title %></title>
    <link rel="icon" type="image/x-icon" href="/images/header/logo32.ico"/>

    <script type="text/javascript" src="/scripts/jquery-3.6.0.min.js"></script>
    <script type="text/javascript" src="/scripts/select2.min.js"></script>

    <link rel="stylesheet" href="/style/select2.min.css"/>
    <link rel="stylesheet" href="/style/w3.css"/>
    <link rel="stylesheet" href="/style/header.css"/>

    <meta charset="utf-8"/>
    <meta name="description" content="Aktuelles Wetter in Straubing, bereitgestellt durch die Wetterstation des Johannes-Turmair-Gymnasiums Straubing"> <!-- TODO: Replace with a dynamic filled value -->
    <meta name="keywords" content="JTG, Wetterdaten">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta name="googlebot-image" content="noindex" />
    <meta name="MSNBot-Media" content="noindex" />
    <!--link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"/-->
<!--    <script type="javascript">-->
<!--        function custom_template(obj){-->
<!--            var data = $(obj.element).data();-->
<!--            var text = $(obj.element).text();-->
<!--            if(data && data['img_src']){-->
<!--                img_src = data['img_src'];-->
<!--                template = $("<div><img src=\"" + img_src + "\" style=\"width:100%;height:150px;\" alt='t'/><p style=\"font-weight: 700;font-size:14pt;text-align:center;\">" + text + "</p></div>");-->
<!--                return template;-->
<!--            }-->
<!--        }-->
<!--        var options = {-->
<!--            'templateSelection': custom_template,-->
<!--            'templateResult': custom_template,-->
<!--        }-->
<!--        $('#id_select2_example').select2(options);-->
<!--        $('.select2-container&#45;&#45;default .select2-selection&#45;&#45;single').css({'height': '220px'});-->

<!--        $(document).ready(function() {-->
<!--            $('.test').select2(options);-->
<!--        });-->
<!--    </script>-->
    <script>
        $(document).ready(function(){
            $("#language").select2({
                templateSelection: formatState,
                templateResult: formatState
            });

            $('#language').on('select2:select', function (e) {
                $.ajax({
                    url: "/api/lang",
                    type: "POST",
                    data: { "lng": $("#language").val() },
                    dataType:"json",
                    success: function () {location.reload();} //TODO Finish this
                });
            });
        });

        function formatState (state) {
            if (!state.id) { return state.text; }
            var $state = $(
                '<span ><img sytle="display: inline-block;" src="/images/' + state.element.value.toLowerCase() + '.png" /> ' + '<p>' + state.text + '</p>' + '</span>'
            );
            return $state;
        }
    </script>
</head>

<div class="navbar navbar-default navbar-static-top" role="navigation">
    <div class="navbar-inner">
        <a class="logo" href="/">
            <figure>
                <img src="/images/header/logo3.svg" height="36px" alt="<%=t('header.navigation.logo-alt')%>" id="logoimage"/>
                <figcaption class="logocaption">
                    <%=t('header.navigation.logo-span')%>
                </figcaption>
            </figure>
        </a>

        <figure class="weatherSmall">
            <img src="/images/weather/svg/cloud.webp" alt="Leicht Bewölkt" height="50px" id="weatherimage">
            <figcaption class="logocaption alwaysShow">
                27°C
            </figcaption>
        </figure>

        <div class="spacer"></div>

        <div class="menu-btn">
            <div class="btn-line"></div>
            <div class="btn-line" style="transition-duration: 0.25s;"></div>
            <div class="btn-line"></div>
        </div>
        <div class="menu w3-sidebar w3-bar-block w3-card w3-animate-right" id="rightMenu">
            <a href="#" class="w3-bar-item w3-button">Link 1</a>
            <a href="#" class="w3-bar-item w3-button">Link 2</a>
            <a href="#" class="w3-bar-item w3-button">Link 3</a>
        </div>
        <script>
            // Select dom items
            const menuBtn =
                document.querySelector(".menu-btn");

            const menu =
                document.querySelector(".menu")


            // Set the initial state of the menu
            let showMenu = false;

            menuBtn.addEventListener("click", toggleMenu);

            function toggleMenu() {
                if (!showMenu) {
                    menuBtn.classList.add("close");
                    menu.classList.add("show");

                    // Reset the menu state
                    showMenu = true;
                } else {
                    menuBtn.classList.remove("close");
                    menu.classList.remove("show")

                    // Reset the menu state
                    showMenu = false;
                }
            }
        </script>
        <ul class="navbar-right" >
            <li>
                <select id="language">
                    <script type="text/javascript">
                        $.ajax({
                            url: "/api/lang-available",
                            type: "GET",
                            dataType:"json",
                            success: function(result) {
                                result.length
                                for (let i = 0; i < result.length; i++) {
                                    document.getElementById('language').insertAdjacentHTML("beforeend",`<option value=${result[i]}>${result[i]}</option>`);
                                }
                            } //TODO Finish this
                        });
                    </script>
                </select>
            </li>
            <li><a href="/login" class="button-top-right">Log in</a></li>
            <li><a href="/About" class="button-top-right">About</a></li>
            <li><a href="/Irgendwas" class="button-top-right">Irgendwas</a></li>
        </ul>
    </div>
</div>

<div class="container">
</html>