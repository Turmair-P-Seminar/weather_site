# Modified Version of 'Connect Session Knex' named 'knex-mysql-session'

Modified to only support MySQL, using stored procedures and select statements only. 

knex-mysql-session is an [express-session](https://github.com/expressjs/session) store backed by MySQL, via the [knex.js](http://knexjs.org/) library.


## Usage

[Example application using the defaults](https://github.com/gx0r/connect-session-knex/blob/master/examples/example.js)

[Example application with PostgreSQL](https://github.com/gx0r/connect-session-knex/blob/master/examples/example-postgres.js)

[With Express 3 or Connect](https://github.com/gx0r/connect-session-knex/blob/master/Oldversions.md)

## Options

 - `tablename='sessions'` Tablename to use. Defaults to 'sessions'.
 - `sidfieldname='sid'` Field name in table to use for storing session ids. Defaults to 'sid'.
 - `knex` knex instance to use. Defaults to a new knex instance, using sqlite3 with a file named 'connect-session-knex.sqlite'
 - `createtable` if the table for sessions should be created automatically or not.
 - `clearInterval` milliseconds between clearing expired sessions. Defaults to 60000.
 - `disableDbCleanup` disables the automatic clearing of expired sessions. Defaults to false. 

If the table does not exist in the schema, this module will attempt to create it unless the 'createtable' option is false.

If a knex instance is not provided, this module will attempt to create a sqlite3 database, with a file named 'connect-session-knex.sqlite', in the working directory of the process.

## Schema

#### Table Name "sessions"  
| Column  |     Type     | Modifiers | Storage  | 
|---------|:------------:|:---------:|:--------:|
| sid     | varchar(255) | not null  | extended |
| sess    |     json     | not null  | extended |
| expired |   datetime   | not null  | plain    |  

### Indexes:
```  
    "sessions_pkey" PRIMARY KEY, btree (sid)  
    "sessions_expired_index" btree (expired)
```

## Benchmarks

[https://github.com/gx0r/express-session-benchmarks](https://github.com/gx0r/express-session-benchmarks)

